## 项目定位与现状
- 目标：打造专注婚纱摄影展示的高性能、易拓展、移动优先网站
- 现状：代码库为 Astro 项目（纯 Astro，无 React/Vue 集成）；已有多种图片效果演示与婚礼主题画廊页
  - 示例：`src/pages/curved-image.astro:17`（“使用说明”）
  - 相关：`src/pages/gallery/wedding.astro`、`src/components/CurvedImageRenderer.astro`、`src/layouts/GalleryLayout.astro`

## 技术架构
- 前端：Astro + React 岛组件（后续可平替为 Vue 岛组件），SSR/SSG 混合
- 资源：`astro:assets` 提供图片优化（`<Image />`、`srcset`、`sizes`）与懒加载
- 后端：轻量 API（Astro API 路由或无服务函数），初期仅占位与监控上报
- 部署/CDN：推荐 Vercel/Netlify（默认全站静态资源走平台 CDN），大图可选 Cloudflare R2/又拍云/七牛
- 配置：后续可引入 `@astrojs/sitemap` 生成站点地图；保留无自定义 Vite 的简单配置

## 核心功能实现
- 高清轮播/画廊
  - 组件：`GalleryGrid`（瀑布流/响应式网格）、`Lightbox`（全屏查看）、`Carousel`（轮播）
  - 响应式：容器查询 + `sizes`/`srcset`，移动端优先布局
- 图片分类管理
  - 分类：室内/室外/主题系列（森系、法式、轻奢等）
  - 交互：顶部 `FilterBar` + 标签筛选、多选；URL 查询参数保持状态
- 适配与回退
  - WebGL效果在低端设备回退到 CSS 动画；统一 `prefers-reduced-motion` 优化可及性

## 前端组件规划
- 页面：`Home`（主视觉+精选）、`Gallery`（分类筛选+列表）、`PhotoDetail`（详情+相关）、`About/Contact`
- 通用组件：`GalleryGrid`、`LazyImage`、`Lightbox`、`Carousel`、`FilterBar`、`Breadcrumbs`、`CategoryTabs`
- 岛组件策略：交互性强的组件用 React 岛；静态内容用 Astro 模板

## 后端与接口
- 轻量 API 路由（仅占位，返回静态/模拟数据）
  - `GET /api/albums`：相册列表（含封面、类别、统计）
  - `GET /api/photos?albumId=...&page=...`：分页照片
  - `POST /api/metrics`：性能埋点上报（`web-vitals` + `PerformanceObserver`）
  - 预留：`GET /api/invitations/:id`（电子请柬占位）、`POST /api/reservations`（预约占位）
  - 预留：`GET /api/auth/wechat/init` 返回 `authorize_url`（不实现登录流程）
- 数据返回统一 JSON，含版本与分页元信息；错误统一 `problem+json`

## 数据模型设计（预留，可轻量实现）
- `Category`：`id`、`name`、`slug`、`coverImage`
- `Album`：`id`、`title`、`categoryId`、`description`、`coverImage`、`shootDate`
- `Photo`：`id`、`albumId`、`src`、`width`、`height`、`lqip`、`tags`、`dominantColor`
- `Reservation`（预留）：`id`、`clientName`、`phone`、`date`、`packageId`、`status`、`note`
- `Package`（预留）：`id`、`name`、`price`、`features`
- 初期数据可为本地 JSON/MDX；后续可接入 SQLite/Supabase 等

## 性能与 SEO
- 图片优化：`loading=lazy`、原生 `srcset/sizes`、LQIP（构建期生成模糊占位）、关键视觉 `preload`
- 渐进式加载：IntersectionObserver 视口内优先；骨架屏 + `decode()` 后淡入
- WebGL/CSS 效果：按需加载与 `requestIdleCallback`，避免主线程卡顿
- SEO：语义化结构、`title/description`、OG/Twitter、`canonical`、`robots.txt`、`sitemap.xml`、图片 `alt`
- 结构化数据：`Organization`、`ImageObject`、`BreadcrumbList` 的 JSON-LD

## 监控与测试
- 性能埋点：`web-vitals`（CLS/LCP/FID/INP）+ 自定义 `PerformanceObserver`，上报到 `/api/metrics`
- 兼容性：Playwright 基本用例（Chromium/Firefox/WebKit）；重点真机 Safari iOS/Android Chrome
- 可及性：`aria`、对比度、键盘可用性；`prefers-reduced-motion` 处理动画

## 交付物与文档（输出到 `.trae/`）
- 需求规格说明书（SRS）
- 系统架构图（Mermaid + PNG 导出）
- 数据库设计文档（ER 模型 + 字段说明）
- 前端组件规划（目录、职责、交互与状态）
- API 接口文档模板（资源、请求/响应、错误与示例）

## 实施步骤
1. 初始化文档与占位 API（`.trae/*` 与 `src/pages/api/*`）
2. 实现 `Gallery` 页面与分类筛选（Astro + React 岛组件）
3. 接入图片优化与懒加载（`astro:assets` + LQIP）
4. 完成 `Lightbox/Carousel` 与响应式适配
5. 添加 SEO/结构化数据与 `sitemap` 插件
6. 埋点与 `/api/metrics` 上报，验证核心 Web Vitals
7. 跨浏览器与可及性测试，修复兼容问题

## 与现有代码的衔接
- 保留并复用现有效果页与布局：`GalleryLayout.astro`、波浪/曲线渲染组件
- 将婚礼主题画廊迁移为主 `Gallery` 页面，补齐分类筛选与缩略图策略
- 对低端设备启用 CSS 回退，缩减 WebGL 着色器复杂度

——
若确认该方案，我将：
- 创建 `.trae/` 文档骨架与 API 占位
- 实作 `Gallery` 与核心图片优化/懒加载
- 衔接现有婚礼画廊并完成 SEO/监控与测试配置