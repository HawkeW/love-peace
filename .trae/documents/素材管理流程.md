# 素材管理流程（小型团队版）

## 目标
- 高质量婚纱摄影图片的稳定上架与更新
- 明确目录、命名与元数据，保证可追溯与可扩展
- 兼顾性能（懒加载/LQIP/srcset）与版权保护（水印/隐私）

## 目录结构
- `public/images/<albumId>/`：原始发布图（JPG/WEBP），按相册分目录
- `src/data/albums/*.json`：相册与图片元数据（标题、拍摄日期、尺寸、标签等）
- `src/assets/`：站点图标与通用图形资源

## 命名规范
- 相册目录：`YYYYMMDD-<slug>`（例：`20250120-paris-elegance`）
- 图片文件：`<sequence>_<short-slug>_<w>x<h>.jpg`（例：`001_veil_1600x1067.jpg`）
- 缩略图：`thumb_<sequence>.jpg`；水印版：`wm_<sequence>.jpg`

## 元数据 Schema（JSON）
```json
{
  "id": "20250120-paris-elegance",
  "title": "法式轻奢 · 巴黎",
  "categoryId": "outdoor",
  "shootDate": "2025-01-20",
  "coverImage": "/images/20250120-paris-elegance/cover.jpg",
  "photos": [
    {
      "id": "001",
      "src": "/images/20250120-paris-elegance/001_veil_1600x1067.jpg",
      "width": 1600,
      "height": 1067,
      "lqip": "",
      "dominantColor": "#a9b1c4",
      "tags": ["veil", "outdoor", "paris"]
    }
  ]
}
```

## 流程步骤
1. 素材入库
   - 摄影师导出选片（sRGB，长边 1600–2560，JPEG/WEBP）
   - 命名与分组到 `public/images/<albumId>/`
2. 元数据录入
   - 在 `src/data/albums/` 新建相册 JSON，填写 `title/categoryId/shootDate/coverImage`
   - 扫描目录填写每张图片 `src/width/height/tags`，可选补充 `dominantColor/lqip`
3. 质量与版权
   - 检查构图与曝光；必要时生成水印版（导出到 `wm_*.jpg`）
   - 敏感信息遮挡；模糊人脸仅在必要时进行
4. 上架与测试
   - 本地预览画廊页，检查移动端加载速度（LCP/INP）
   - 验证 `Lightbox/Carousel` 行为与 SEO 元信息
5. 发布与CDN
   - 部署平台（Vercel/Netlify）自动走 CDN；必要时绑定对象存储
   - 大图走 CDN 域名；页面资源走主域名

## 性能策略
- 懒加载：全站 `loading="lazy"`；视口进入后触发 `decode()` + 渐进淡入
- 响应式：准备 3–4 个尺寸（如 640/1024/1600/2560），使用 `srcset/sizes`
- LQIP：可选在构建前生成 data URI 并写入 JSON；或使用 CSS blur 过渡（已默认）
- 关键图：首屏主视觉允许 `preload`，避免闪烁

## 分类与标签
- 类别：`indoor/outdoor/theme`（与页面筛选一致）
- 标签示例：`veil/dress/couple/portrait/sunset/city/forest`
- URL 查询参数保持筛选状态（例：`?category=outdoor`）

## 变更与版本
- 相册 JSON 使用 `id` 作为主键；允许追加图片与更新元信息
- 变更后在本地预览与埋点检查（`/api/metrics`）

## 隐私与合规
- 获得被摄主体授权（展示范围、平台、时效）
- 处理拍摄地点或车牌等敏感信息

## 与现有代码的对应
- 画廊页：`src/pages/gallery/index.astro` 当前示例硬编码，可切换为读取 `src/data/albums/*.json`
- 大图与轮播：`src/components/Lightbox.astro`、`src/components/Carousel.astro`
- 监控：`src/pages/api/metrics.ts` 与 `src/layouts/GalleryLayout.astro` 上报逻辑

## 小团队简化建议
- 前期以 JSON+文件夹管理为主，不引入数据库
- 每次拍摄按相册落库，1–2人审核后直接上架
- 真正需要后台时再接入托管数据库与管理页面

